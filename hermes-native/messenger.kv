#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:include lists/conversation.kv
#:include lists/message.kv
#:include screens/add.kv
#:include screens/contacts.kv
#:include screens/settings.kv
#:include screens/conversation.kv

<MainWindow>:
	cols: 2
	rows: 2
	RecycleView:
		id: conversation_list
		size_hint_x: None
		size_hint_y: 1
		width: 200
		scroll_type: ['bars','content']
		scroll_wheel_distance: 100
		bar_width: 10
		viewclass: 'ConversationListItemView'
		RecycleBoxLayout:
			default_size: None, 100
			default_size_hint: 1, None
			size_hint_y: None
			height: self.minimum_height
			orientation: 'vertical'
			spacing: 0

	ScreenManager:
		id: screen_controls
		size_hint_x: 1
		size_hint_y: 1
		transistion: SlideTransition
		SettingScreen:
		ContactsScreen:
		AddConversationScreen:

	BoxLayout:
		id: general_controls
		size_hint_x: None
		size_hint_y: None
		width: 200
		height: 60
		Button:
			id: go_to_menu
			text: 'settings'
			on_press: root.transition(0)
		Button:
			id: go_to_contacts
			text: 'contacts'
			on_press: root.transition(1)

	BoxLayout:
		id: input_controls
		orientation: 'vertical'
		size_hint_x: 0.8
		size_hint_y: None
		height: 60
		BoxLayout:
			id: conversation_controls
			height: 24
			Button:
				id: add
				text: 'add'
				size_hint_x: None
				width: 100
				on_press: root.transition(2)
			Button:
				id: leave
				text: 'leave'
				size_hint_x: None
				width: 100
				on_press: root.leave_conversation()
			Button:
				size_hint_x: 1
		BoxLayout:
			id: message_controls
			height: 36
			BoxLayout:
				id: text_entry_container
				size_hint_x: 1
				size_hint_y: None
				height: min(text_entry.line_height * 5, 16 * (len(text_entry._lines)+1))
				TextInput:
					id: text_entry
					text: ""
					font_size: 16
					size_hint_x: None
					size_hint_y: None
					width: text_entry_container.width
					height: max( (len(self._lines)+1) * 16, text_entry_container.height)
			Button:
				id: send
				size_hint_x: None
				width: 50
				text: 'send'
				on_press: root.send_message()
